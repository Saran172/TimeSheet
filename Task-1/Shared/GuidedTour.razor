@using Blazored.SessionStorage
@using Microsoft.AspNetCore.Components.Server.ProtectedBrowserStorage
@inject ProtectedLocalStorage _localStorage;


@if (showTour)
{
    <div class="tour-overlay" role="dialog" aria-modal="true" aria-label="Guided tour">
        <div class="tour-card" role="document">
            <div class="tour-header">
                <div class="tour-title-wrap">
                    <h4 class="tour-title">@CurrentStep.Title</h4>
                    <div class="tour-subtitle">Step @(stepIndex + 1) of @steps.Count</div>
                </div>
                <button class="tour-close" aria-label="Close tour" @onclick="SkipTour">
                    <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                        <path fill="currentColor" d="M18.3 5.71a1 1 0 0 0-1.41 0L12 10.59 7.11 5.7A1 1 0 0 0 5.7 7.11L10.59 12l-4.9 4.89a1 1 0 1 0 1.41 1.41L12 13.41l4.89 4.9a1 1 0 0 0 1.41-1.41L13.41 12l4.9-4.89a1 1 0 0 0 0-1.4z"/>
                    </svg>
                </button>
            </div>

            <div class="tour-body">
                <p>@CurrentStep.Description</p>
            </div>

            <div class="tour-footer">
                <div class="tour-left">
                    <button class="btn" @onclick="PrevStep" disabled="@(stepIndex == 0)">Previous</button>
                </div>

                <div class="tour-center">
                    <div class="tour-progress">
                        @for (int i = 0; i < steps.Count; i++)
                        {
                            <span class="dot @(i == stepIndex ? "active" : "")" aria-hidden="true"></span>
                        }
                    </div>
                </div>

                <div class="tour-right">
                    <button class="btn" @onclick="SkipTour">Skip</button>
                    <button class="btn" @onclick="NextStep">@((stepIndex == steps.Count - 1) ? "Finish" : "Next")</button>
                </div>
            </div>
        </div>
    </div>
}



<script>
    function triggerShine() {
        const el = document.querySelector('.tour-overlay[b-hhjnc77cth]');
        if (!el) return;

        el.classList.remove('shine-flash');

        setTimeout(() => {
            el.classList.add('shine-flash');
        }, 30);
    }

    triggerShine();

    setInterval(triggerShine, 6000);
</script>
